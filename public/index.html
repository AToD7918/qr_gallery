<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>메뉴</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
      background: #1a1a1a;
      overflow: hidden;
      height: 100dvh;  /* 100vh → 100dvh */
      width: 100vw;
      -webkit-user-select: none;
      user-select: none;
    }
    
    .container {
      position: relative;
      width: 100%;
      height: 100dvh; /* 100vh → 100dvh */
      display: flex;
      flex-direction: column;
      background: #1a1a1a;
    }
    
    .slider-container {
      flex: 1;
      position: relative;
      overflow: hidden;
      background: #1a1a1a;
      height: 100dvh; /* 100vh → 100dvh */
    }
    
    .slider {
      display: flex;
      height: 100%;
      transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      align-items: flex-start; /* 가용 높이 상단 기준 정렬 */
    }

    .slider.zoomed {
      transition: none;
    }
    
    .slide {
      min-width: 100%;
      height: 100dvh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      position: relative;
    }

    .image-wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      position: relative;
    }

    .image-wrapper.zoom-mode {
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      cursor: grab;
      display: block;
      align-items: unset;
      justify-content: unset;
      padding: 0;
    }

    .image-wrapper.zoom-mode:active {
      cursor: grabbing;
    }
    
    .slide img {
      width: 100%;
      height: 100dvh;
      object-fit: contain;
      border-radius: 0;
      box-shadow: none;
      transition: width 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                  height 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      display: block;
      margin: 0;
    }

    .slide img.zoomed {
      border-radius: 0;
      max-width: none;
      max-height: none;
      margin: 0;
      object-fit: contain;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="slider-container">
      <div class="slider" id="slider"></div>
    </div>
  </div>

  <script>
    const images = [
      'img/photo.jpg',
      'img/photo1.jpg',
      'img/photo2.jpg'
    ];

    let currentIndex = 0;
    const slider = document.getElementById('slider');

    // 모바일 브라우저 주소창 숨김
    function hideAddressBar() {
      window.scrollTo(0, 1);
      setTimeout(() => window.scrollTo(0, 0), 0);
    }

    // 슬라이드 생성
    images.forEach((src, index) => {
      const slide = document.createElement('div');
      slide.className = 'slide';
      
      const wrapper = document.createElement('div');
      wrapper.className = 'image-wrapper';
      
      const img = document.createElement('img');
      img.src = src;
      img.alt = `메뉴 ${index + 1}`;
      img.loading = index === 0 ? 'eager' : 'lazy';
      
      // 이미지 확대/축소 기능
      let isZoomed = false;
      let imgNaturalWidth = 0;
      let imgNaturalHeight = 0;
      let imgDisplayWidth = 0;
      let imgDisplayHeight = 0;

      // 이미지 로드 완료 시 크기 저장
      img.addEventListener('load', () => {
        imgNaturalWidth = img.naturalWidth;
        imgNaturalHeight = img.naturalHeight;
        updateDisplaySize();
      });

      function updateDisplaySize() {
        if (!isZoomed) {
          const rect = img.getBoundingClientRect();
          imgDisplayWidth = rect.width;
          imgDisplayHeight = rect.height;
        }
      }

      // 더블탭으로 확대/축소
      let lastTap = 0;
      let tapTimeout = null;

      wrapper.addEventListener('touchend', (e) => {
        const currentTime = new Date().getTime();
        const tapLength = currentTime - lastTap;
        
        if (tapLength < 300 && tapLength > 0) {
          e.preventDefault();
          clearTimeout(tapTimeout);
          
          if (!isZoomed) {
            // 확대
            const touch = e.changedTouches[0];
            const imgRect = img.getBoundingClientRect();
            
            // 터치한 위치 (뷰포트 기준)
            const touchClientX = touch.clientX;
            const touchClientY = touch.clientY;
            
            // 이미지 내에서 터치한 상대적 위치 (0~1 비율)
            const relativeX = (touchClientX - imgRect.left) / imgRect.width;
            const relativeY = (touchClientY - imgRect.top) / imgRect.height;
            
            const currentWidth = imgRect.width;
            const currentHeight = imgRect.height;
            
            const scale = 2;
            const newWidth = currentWidth * scale;
            const newHeight = currentHeight * scale;
            
            isZoomed = true;
            img.classList.add('zoomed');
            wrapper.classList.add('zoom-mode');
            slider.classList.add('zoomed');
            
            img.style.width = newWidth + 'px';
            img.style.height = newHeight + 'px';
            
            requestAnimationFrame(() => {
              // 확대된 이미지에서 같은 비율 위치를 계산
              const targetX = newWidth * relativeX;
              const targetY = newHeight * relativeY;
              
              // 터치한 지점이 화면 중앙에 오도록 스크롤
              const wrapperRect = wrapper.getBoundingClientRect();
              wrapper.scrollLeft = targetX - (touchClientX - wrapperRect.left);
              wrapper.scrollTop = targetY - (touchClientY - wrapperRect.top);
            });
            
          } else {
            // 축소
            isZoomed = false;
            img.classList.remove('zoomed');
            wrapper.classList.remove('zoom-mode');
            slider.classList.remove('zoomed');
            
            img.style.width = '';
            img.style.height = '';
            
            wrapper.scrollLeft = 0;
            wrapper.scrollTop = 0;
          }
        }
        
        lastTap = currentTime;
      }, { passive: false });

      wrapper.appendChild(img);
      slide.appendChild(wrapper);
      slider.appendChild(slide);
    });

    function updateSlider() {
      slider.style.transform = `translateX(-${currentIndex * 100}%)`;
    }

    // 터치 스와이프 기능
    let touchStartX = 0;
    let touchEndX = 0;
    let isSwiping = false;

    slider.addEventListener('touchstart', (e) => {
      // 확대된 상태에서는 스와이프 비활성화
      if (slider.classList.contains('zoomed')) return;
      
      touchStartX = e.changedTouches[0].screenX;
      isSwiping = true;
    }, { passive: true });

    slider.addEventListener('touchmove', (e) => {
      if (!isSwiping || slider.classList.contains('zoomed')) return;
    }, { passive: true });

    slider.addEventListener('touchend', (e) => {
      // 확대된 상태에서는 스와이프 비활성화
      if (slider.classList.contains('zoomed')) return;
      if (!isSwiping) return;
      
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
      isSwiping = false;
    }, { passive: true });

    function handleSwipe() {
      const swipeThreshold = 50;
      const diff = touchStartX - touchEndX;

      if (Math.abs(diff) > swipeThreshold) {
        if (diff > 0 && currentIndex < images.length - 1) {
          // 왼쪽 스와이프 (다음)
          currentIndex++;
          updateSlider();
        } else if (diff < 0 && currentIndex > 0) {
          // 오른쪽 스와이프 (이전)
          currentIndex--;
          updateSlider();
        }
      }
    }

    // 키보드 네비게이션
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft' && currentIndex > 0) {
        currentIndex--;
        updateSlider();
      } else if (e.key === 'ArrowRight' && currentIndex < images.length - 1) {
        currentIndex++;
        updateSlider();
      }
    });

    // 초기화 및 주소창 숨김
    window.addEventListener('load', () => {
      hideAddressBar();
      updateSlider();
    });
    
    // 스크롤 시 주소창 재숨김
    window.addEventListener('scroll', hideAddressBar);
    window.addEventListener('orientationchange', hideAddressBar);
  </script>
</body>
</html>
